@page "/actions/{DashboardActionId:int}"
@page "/actions/new"
@inherits ActionsEditPage

<EditForm EditContext="@ActionEditContext">
    <DataAnnotationsValidator />

    <fieldset>
        <legend>
            Action
            @if (DashboardActionId != 0)
            {
                <button class="btn btn-outline-danger float-right" @onclick="ConfirmDelete">Delete</button>
            }
        </legend>
        @if (DashboardActionId == 0)
        {
            <div class="form-group disabled">
                <label for="ActionType">Action Type</label>
                <ActionTypeInputSelect @bind-Value="DashboardAction.ActionTypeName" OptionSelected="@ChangeActionTypeName" />
            </div>
        }
        else if (!string.IsNullOrWhiteSpace(ActionAttribute?.Title))
        {
            <div class="form-group disabled">
                <label for="ActionType">Type</label>
                <input type="text" class="form-control" value="@ActionAttribute.Title" disabled />
            </div>
        }
        <div class="form-group">
            <label for="Title">Title</label>
            <InputText @bind-Value=@DashboardAction.Title class="form-control" id="Title" placeholder="Enter text to display" />
            <ValidationMessage For="() => DashboardAction.Title" />
        </div>
        <div class="form-group">
            <label for="BackgroundColor">Background Color</label>
            <InputColor @bind-Value=@DashboardAction.BackgroundColor class="form-control" id="BackgroundColor" />
            <ValidationMessage For="() => DashboardAction.BackgroundColor" />
        </div>
        <div class="form-group">
            <label for="Icon">Icon</label>
            <InputText @bind-Value=DashboardAction.Icon class="form-control" id="Icon" placeholder="Enter a relative URL path to an image file" />
            <small>An optional image to be displayed for this action.</small>
            <ValidationMessage For="() => DashboardAction.Icon" />
        </div>
    </fieldset>

    @if (ParametersEditContext != null)
    {
        <fieldset>
            <legend>Parameters</legend>
            <FormGenerator EditContext="@ParametersEditContext" FormElementType="typeof(ActionPropertyFormElement)"></FormGenerator>
        </fieldset>
    }

    <div class="float-right">
        <button class="btn btn-secondary" @onclick=CancelChanges>Cancel</button>
        <button class="btn btn-primary" @onclick="SaveChanges">Save</button>
    </div>
</EditForm>